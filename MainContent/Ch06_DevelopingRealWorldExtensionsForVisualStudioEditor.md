---
sort: 6
---

# 비주얼 스튜디오 편집기용 리얼월드 확장 개발
지금까지는 개발자가 가장 자주 사용하는 Visual Studio의 핵심 부분인 코드 편집기를 확장하지 않았습니다. Visual Studio 편집기는 다양한 확장 지점 집합을 제공하며 대부분의 부분은 MEF(Managed Extensibility Framework)를 통해 확장할 수 있습니다. 사실, 편집기가 노출한 확장성 포인트가 너무 많아서 각각을 자세히 다루려면 책 한 권이 필요합니다. 다행스럽게도 Microsoft는 이미 이러한 확장성 지점과 기능을 매우 깊이 있게 문서화했습니다. 이 장에서는 Visual Studio 편집기의 확장성 포인트에 대해 논의하고 코드 분석, 수정 및 리팩토링을 위한 확장을 개발합니다. Visual Studio 편집기 확장을 시작하기 전에 편집기, 해당 하위 시스템, 기능 및 확장성 지점을 이해하는 것이 중요합니다. 다음 섹션에서는 편집기에 대해 논의한 다음 확장에 대해 자세히 설명합니다.

***
## <font color='dodgerblue' size="6">1) 비주얼 스튜디오 에디터</font>
Visual Studio 편집기는 아마도 Visual Studio에서 가장 자주 사용되는 구성 요소일 것입니다. 여기에서 개발자가 지원되는 언어 중 하나로 코드를 작성, 보기, 편집 및 디버그할 수 있습니다. 그림 6-1은 C# 언어용 Visual Studio 편집기와 그 여러 부분을 보여줍니다. 다른 부품에는 쉽게 참조하고 식별할 수 있도록 번호가 매겨져 있습니다. 번호가 매겨진 항목은 다음에 논의됩니다. 그것들은 다음과 같습니다:

  ![06_01_CodeEditor](image/06/06_01_CodeEditor.png)   
  그림 6-01 Visual Studio 코드 편집기

  - **1. 코드 편집기**  
      문서가 편집되고 표시되는 핵심 편집기 영역입니다. IntelliSense의 핵심 기능도 이 지역에서 등장합니다. 이 영역을 마우스 오른쪽 버튼으로 클릭하면 이전 장에서 이미 보고 논의한 컨텍스트 메뉴가 표시됩니다.

  - **2. 프로젝트 드랍다운**  
    이 드롭다운은 파일이 열려 있는 활성 프로젝트를 표시합니다. Visual Studio에서 고아 파일을 열면 이 드롭다운에 기타 파일이 표시됩니다.

  - **3. 타입 드랍다운**  
    이 드롭다운에는 활성 문서에 정의된 모든 유형이 나열됩니다. 이 드롭다운은 선택한 값을 편집 중이거나 활성화된 유형, 즉 커서가 있는 위치로 표시합니다.

  - **4. 멤버 드랍다운**  
    선택또는 활성 타입의 모든 멤버(생성자, 필드, 속성, 메쏘드)가 나열.

  - **5. 윈도우 분할**  
    코드 편집기 창을 분할하기 위해.

  - **6. 스크롤바**  
    코드 창의 특정 섹션으로 쉽게 이동하고 창의 섹션을 보기 위해 사용합니다. 그림 6-1은 수직 스크롤바를 보여줍니다. 코드에 따라 편집기 하단에 가로 스크롤 막대가 표시될 수도 있습니다.

  - **7. 줄 번호**  
    파일에서 줄번호 표시

  - **8. 선택 마진**  
    이것은 라인 번호와 아웃라인 표시기 사이의 위치입니다. 코드를 수정할 때 해당 행은 코드 편집기의 왼쪽에 있는 색상으로 강조 표시됩니다. 선택 여백은 코드 변경 사항을 표시하는 데 사용되며 클릭 한 번으로 전체 코드 줄을 선택할 수 있습니다.

  - **9. 중괄호 완성**  
    편집기는 중괄호 완성 기능을 제공하고 해당 개구부를 강조 표시합니다.

  - **10. 표시기 여백**  
    이것은 편집기의 왼쪽에 있는 얇은 회색 영역입니다. 코드 줄에 대해 중단점과 책갈피가 표시되는 영역입니다.

  - **11. 확대 레벨**  
    이것은 코드 편집기를 확대하거나 축소하여 편집기에서 더 크거나 작은 글꼴 크기를 보는 데 사용할 수 있습니다.

이제 우리는 Visual Studio 편집기의 높은 수준의 개요를 보았습니다. 이제 편집기의 하위 시스템에 대해 논의할 시간입니다.

***

- ### A. 에디터 서브시스템
    - **1. 모델 서브시스템**  
    - **2. TextView 서브시스템**  
    - **3. Classification 서브시스템**  
    - **4. operation 서브시스템**  

- ### B. 에디터 기능들
    - **1. Tags**  
        텍스트 범위에 태그를 지정하거나 표시하는 데 사용됩니다. 태깅은 텍스트에 강조 표시, 색상 지정, 개요 또는 밑줄을 긋거나 그래픽 또는 팝업을 표시하여 시각적으로 표시됩니다. 예를 들어 구문 강조 표시는 분류자를 통해 수행되므로 일종의 태그입니다. 태깅을 사용하여 컴파일 오류와 같은 오류를 표시할 수도 있습니다. 태그 지정에 사용되는 몇 가지 유형은 다음과 같습니다.

        - **TextMarkerTag**
          텍스트 하이라이팅 용도 
        - **OutliningRegionText**
          아웃라인 표시 
        - **ErrorTag**
          에러 표시용. 편집기의 많은 기능들이 태그에 기반. 그림 6-7은 강조된 구불구불 에러 태그 표시

        ![06_07_ErrorTag](image/06/06_07_ErrorTag.png)   
        그림 6-07 에러 태그 작동

    - **2. Classifier**  
        분류기는 이름에서 알 수 있듯이 텍스트를 카테고리하거나 분류합니다. 분류기는 여러 분류 또는 범주가 있을 수 있으므로 IClassifier 인터페이스를 구현하여 콘텐츠 유형에 대해 정의됩니다. 그것들은 IClassificationType 인터페이스에 의해 정의됩니다. 분류기는 코드 텍스트를 주석, 키워드 또는 식별자로 분류할 수 있습니다.
        영어 알파벳을 모음, 자음 등으로 분류합니다. 분류기 형태의 인스턴스를 classification(분류)라고 한다. 그런 다음 다음 역할을 하는 분류기 집계기가 있습니다.
        분류기는 텍스트를 분류 세트로 나눕니다. 편집기의 텍스트 형식은 텍스트 분류를 기반으로 합니다. 텍스트는 키워드, 리터럴, 주석, 식별자 등으로 분류되며, 텍스트 보기 하위 시스템은 분류에 따라 텍스트의 서식을 지정하고 강조 표시하고 색상을 지정합니다. 그림 6-8은 C# 코드의 다른 부분을 표시하는 데 사용되는 다양한 색상을 보여줍니다. 이것은 분류를 통해 발생합니다.

        ![06_08_ToolTipAdornment](image/06/06_08_DiffClassifiColor.png)   
        그림 6-08 다른 분류와 다른 색깔

    - **3. Adornments**  
        장식이라는 단어의 문자적 의미는 꾸미기 또는 장식입니다. 마찬가지로 Visual Studio 편집기의 컨텍스트에서 텍스트의 글꼴 및 색상을 제외한 모든 텍스트 장식 또는 그래픽을 장식이라고 합니다. 오류 및 경고에 대한 코드 조각의 빨간색과 녹색 물결선은 장식의 좋은 예입니다. 툴팁은 또 다른 장식품입니다. WPF 기반의 편집기 UI에 표시되기 때문에 모든장식은 UIElement에서 파생되고 ITag를 구현해야 합니다. 그림 6-9는 편집기에서 string 키워드 위로 마우스를 가져갈 때 string에 대한 도구 설명 장식을 보여줍니다.

        ![06_09_ToolTipAdornment](image/06/06_09_ToolTipAdornment.png)   
        그림 6-09 툴팁 꾸미기

    - **4. Projection**  
    - **5. Outlining**  
    - **6. Operations**  
    - **7. IntelliSense**  

## <font color='dodgerblue' size="6">2) 에디터 확장성</font>

- ### A. 코드 픽스와 진단 분석기
- ### B. 코드 픽스와 진단 코드 분석기 만들기
    - **1. 프로젝트 셋업**  
    - **2. SupportedDiagnostics**  
    - **3. Initialize**  
    - **4. 진단 분석기 코딩**  
    - **5. 진단 분석기 실행**  
    - **6. 코드 픽스 만들기**  
    - **7. 확장도구 테스트**  
    - **8. 확장도구 배포**  

## <font color='dodgerblue' size="6">3) 코드 리팩토링 확장도구</font>
- ### A. 확장도구 코딩
- ### B. 리팩토링 테스팅

## <font color='dodgerblue' size="6">4) 인텔리센스</font>

## <font color='dodgerblue' size="6">5) 인텔리코드</font>

## <font color='dodgerblue' size="6">6) 요약</font>

## <font color='dodgerblue' size="6">7) 클래스 레퍼런스</font>


    